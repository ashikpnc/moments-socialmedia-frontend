{"ast":null,"code":"var _jsxFileName = \"/home/ashik/Projects/Moments/frontend/src/components/chatComponents/chatBox/index.js\",\n    _s = $RefreshSig$();\n\nimport \"./style.css\";\nimport { useSelector } from \"react-redux\";\nimport { useEffect, useReducer, useRef, useState } from \"react\";\nimport { getAllMessages, messenger } from \"../../../functions/chat\";\nimport PuffLoader from \"react-spinners/PuffLoader\";\nimport { messagesReducer } from \"../../../functions/reducers\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ChatBox(_ref) {\n  _s();\n\n  let {\n    selectedChat\n  } = _ref;\n  const {\n    user\n  } = useSelector(state => ({ ...state\n  }));\n  const [loading, setLoading] = useState(false);\n  const [{\n    messagesLoading,\n    messages,\n    error\n  }, dispatch] = useReducer(messagesReducer, {\n    messagesLoading: false,\n    messages: [],\n    error: false\n  });\n  const messageContainerRef = useRef(null);\n  const [message, setMessage] = useState(\"\");\n\n  const sendMessage = async () => {\n    setLoading(true);\n    await messenger(selectedChat.id, message, user.token);\n    setLoading(false);\n  };\n\n  const getMessages = async () => {\n    try {\n      dispatch({\n        type: \"MESSAGES_REQUEST\"\n      });\n      const {\n        data,\n        status\n      } = await getAllMessages(selectedChat.id, user.token);\n\n      if (status === \"ok\") {\n        dispatch({\n          type: \"CHAT_CONTACTS_SUCCESS\",\n          payload: data\n        });\n      }\n    } catch (error) {\n      dispatch({\n        type: \"CHAT_CONTACTS_ERROR\"\n      });\n    }\n  };\n\n  useEffect(() => {\n    getMessages();\n  }, [selectedChat]); // useEffect(() => {\n  //   messageContainerRef.current.scrollTop =\n  //     messageContainerRef.current.scrollHeight;\n  // }, []);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chatBox\",\n    children: [!selectedChat.id && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"noSelectedChat\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Select a chat to start messaging\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 9\n    }, this), selectedChat.id && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat_box_wrap\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat_box_header\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: selectedChat.picture,\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n          children: `${selectedChat.first_name} ${selectedChat.last_name}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"online\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 60,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messageContainerRef,\n        className: \"message_container scrollbar\",\n        children: messages.reverse().map((messageObj, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `${messageObj.id === user.id ? \"sending\" : \"receiving\"}`,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `sending_receiving_inner ${messageObj.id === user.id ? \"sending_inner\" : \"receiving_inner\"}`,\n            children: \"123\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 17\n          }, this)\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat_text_box\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          value: message,\n          onChange: e => setMessage(e.target.value),\n          placeholder: \"Send a message...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 13\n        }, this), !loading && /*#__PURE__*/_jsxDEV(\"svg\", {\n          viewBox: \"0 0 512 512\",\n          onClick: sendMessage,\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            d: \"M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L277.3 424.9l-40.1 74.5c-5.2 9.7-16.3 14.6-27 11.9S192 499 192 488V392c0-5.3 1.8-10.5 5.1-14.7L362.4 164.7c2.5-7.1-6.5-14.3-13-8.4L170.4 318.2l-32 28.9 0 0c-9.2 8.3-22.3 10.6-33.8 5.8l-85-35.4C8.4 312.8 .8 302.2 .1 290s5.5-23.7 16.1-29.8l448-256c10.7-6.1 23.9-5.5 34 1.4z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 15\n        }, this), loading && /*#__PURE__*/_jsxDEV(PuffLoader, {\n          color: \"#fff\",\n          size: 30\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ChatBox, \"bJOfmcm5NRL1BDgOOiwOsp1v/6M=\", false, function () {\n  return [useSelector];\n});\n\n_c = ChatBox;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChatBox\");","map":{"version":3,"sources":["/home/ashik/Projects/Moments/frontend/src/components/chatComponents/chatBox/index.js"],"names":["useSelector","useEffect","useReducer","useRef","useState","getAllMessages","messenger","PuffLoader","messagesReducer","ChatBox","selectedChat","user","state","loading","setLoading","messagesLoading","messages","error","dispatch","messageContainerRef","message","setMessage","sendMessage","id","token","getMessages","type","data","status","payload","picture","first_name","last_name","reverse","map","messageObj","i","e","target","value"],"mappings":"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","sourcesContent":["import \"./style.css\";\nimport { useSelector } from \"react-redux\";\nimport { useEffect, useReducer, useRef, useState } from \"react\";\nimport { getAllMessages, messenger } from \"../../../functions/chat\";\nimport PuffLoader from \"react-spinners/PuffLoader\";\nimport { messagesReducer } from \"../../../functions/reducers\";\n\nexport default function ChatBox({ selectedChat }) {\n  const { user } = useSelector((state) => ({ ...state }));\n  const [loading, setLoading] = useState(false);\n  const [{ messagesLoading, messages, error }, dispatch] = useReducer(\n    messagesReducer,\n    {\n      messagesLoading: false,\n      messages: [],\n      error: false,\n    }\n  );\n\n  const messageContainerRef = useRef(null);\n  const [message, setMessage] = useState(\"\");\n  const sendMessage = async () => {\n    setLoading(true);\n    await messenger(selectedChat.id, message, user.token);\n    setLoading(false);\n  };\n  const getMessages = async () => {\n    try {\n      dispatch({ type: \"MESSAGES_REQUEST\" });\n      const { data, status } = await getAllMessages(\n        selectedChat.id,\n        user.token\n      );\n      if (status === \"ok\") {\n        dispatch({ type: \"CHAT_CONTACTS_SUCCESS\", payload: data });\n      }\n    } catch (error) {\n      dispatch({ type: \"CHAT_CONTACTS_ERROR\" });\n    }\n  };\n  useEffect(() => {\n    getMessages();\n  }, [selectedChat]);\n  // useEffect(() => {\n  //   messageContainerRef.current.scrollTop =\n  //     messageContainerRef.current.scrollHeight;\n  // }, []);\n  return (\n    <div className=\"chatBox\">\n      {!selectedChat.id && (\n        <div className=\"noSelectedChat\">\n          <div>Select a chat to start messaging</div>\n        </div>\n      )}\n      {selectedChat.id && (\n        <div className=\"chat_box_wrap\">\n          <div className=\"chat_box_header\">\n            <img src={selectedChat.picture} alt=\"\" />\n            <h4>{`${selectedChat.first_name} ${selectedChat.last_name}`}</h4>\n            <div>online</div>\n          </div>\n          <div\n            ref={messageContainerRef}\n            className=\"message_container scrollbar\"\n          >\n            {messages.reverse().map((messageObj, i) => (\n              <div\n                className={`${\n                  messageObj.id === user.id ? \"sending\" : \"receiving\"\n                }`}\n                key={i}\n              >\n                <div\n                  className={`sending_receiving_inner ${\n                    messageObj.id === user.id\n                      ? \"sending_inner\"\n                      : \"receiving_inner\"\n                  }`}\n                >\n                  123\n                </div>\n              </div>\n            ))}\n          </div>\n          <div className=\"chat_text_box\">\n            <input\n              value={message}\n              onChange={(e) => setMessage(e.target.value)}\n              placeholder=\"Send a message...\"\n            />\n            {!loading && (\n              <svg viewBox=\"0 0 512 512\" onClick={sendMessage}>\n                <path d=\"M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L277.3 424.9l-40.1 74.5c-5.2 9.7-16.3 14.6-27 11.9S192 499 192 488V392c0-5.3 1.8-10.5 5.1-14.7L362.4 164.7c2.5-7.1-6.5-14.3-13-8.4L170.4 318.2l-32 28.9 0 0c-9.2 8.3-22.3 10.6-33.8 5.8l-85-35.4C8.4 312.8 .8 302.2 .1 290s5.5-23.7 16.1-29.8l448-256c10.7-6.1 23.9-5.5 34 1.4z\" />\n              </svg>\n            )}\n            {loading && <PuffLoader color=\"#fff\" size={30} />}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}